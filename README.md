# 畳み込みニューラルネットワークを用いたテキスト分類器
テキスト情報を用いたユーザ属性推定を想定している．ユーザが興味を示した複数のコンテンツのタイトルからユーザの属性を推定する．
コンテンツごとにテキストを区切ってnumpy配列化したものを入力とすることで，異なるコンテンツ間の単語の時系列性を学習しないように実装されている．
## ※サンプルコード（Sample.ipynb）参照
###  入力①：labels
(ユーザ数)次元のnumpy配列．各要素は各ユーザの分類ラベル．
### 入力②：texts
(ユーザ数)次元のnumpy配列．各要素は各ユーザが興味を示したコンテンツのタイトルで，形式はnumpy配列．コンテンツごとにテキストを区切って配列にすることで，異なるコンテンツを跨いだ単語の時系列性を学習してしまうことを防ぐ．
### データ入力例
#### 「就活生必見のテクニック」「大学偏差値ランキング」「学生向けイベントの紹介」という３つの記事を読んだ学生ユーザの場合
```
import numpy as np
labels = np.array(['学生']) #そのユーザの分類ラベル
texts = np.array(['就活生必見のテクニック','大学偏差値ランキング','学生向けイベントの紹介']) 
```
#### 複数のユーザの場合
```
import numpy as np
labels = np.array(['学生','主婦',...]) #ユーザ数の次元を持った配列．各要素は各ユーザの分類ラベル．
texts = np.array([['就活生必見のテクニック','大学偏差値ランキング','学生向けイベントの紹介'],
                  ['ベテラン主婦の驚きの生活術','へそくりの上手な隠し方','ママ友社会の生き抜き方'],
                  ...]])
```

## CNN_textクラスの説明
### 引数
tagger : 形態素解析器のtagger   
model : 学習済みword2vecモデル   
filter_sizes : CNNで時系列性を考慮する単語数   
n_epochs : エポック数   
### メソッド
#### fit(labels,texts)
上記のlabels,textsを引数にとり，CNNの学習とテストを行うことでCNN_text.Resultsを更新していく．全エポックが終了する前に打ち切った場合は，そこまでの結果がCNN_text.Resultsに保存されている．
#### predict(texts)
上記のtextsを引数にとり，各ユーザに対する推定ラベルと推定所属確率を返す．
戻り値1 : (ユーザ数)次元のnumpy配列．
戻り値2 : (ユーザ数,クラス数)のshapeを持ったnumpyの2次元配列．
### 結果の保存
#### 誤差，正解率，コンフュージョンマトリクス
CNN_text.Resultsに，訓練データを用いて学習したモデルをテストデータに用いた場合の結果をエポックごとに記録している．形式はpandas.DataFrame．
#### 最も性能の良いモデル
'model/Best_model.ckpt'に，最も誤差の小さかったモデルの情報が保存されている．saver.restore()で復元可能．
